# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file 'untitled2.ui'
#
# Created by: PyQt5 UI code generator 5.15.6
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.


from PyQt5 import QtCore, QtGui, QtWidgets
from selenium import webdriver
import time
import datetime
from selenium.webdriver.common.keys import Keys


class Ui_Principal(object):
    def setupUi(self, Principal):
        Principal.setObjectName("Principal")
        Principal.setEnabled(True)
        Principal.resize(163, 300)
        Principal.setMaximumSize(QtCore.QSize(163, 300))
        Principal.setCursor(QtGui.QCursor(QtCore.Qt.ArrowCursor))
        Principal.setSizeGripEnabled(True)
        Principal.setModal(False)
        self.formLayout = QtWidgets.QFormLayout(Principal)
        self.formLayout.setObjectName("formLayout")
        self.label = QtWidgets.QLabel(Principal)
        self.label.setObjectName("label")
        self.formLayout.setWidget(0, QtWidgets.QFormLayout.LabelRole, self.label)
        self.correo = QtWidgets.QLineEdit(Principal)
        self.correo.setObjectName("correo")
        self.formLayout.setWidget(1, QtWidgets.QFormLayout.LabelRole, self.correo)
        self.label_2 = QtWidgets.QLabel(Principal)
        self.label_2.setObjectName("label_2")
        self.formLayout.setWidget(2, QtWidgets.QFormLayout.LabelRole, self.label_2)
        self.label_3 = QtWidgets.QLabel(Principal)
        self.label_3.setObjectName("label_3")
        self.formLayout.setWidget(4, QtWidgets.QFormLayout.LabelRole, self.label_3)
        self.nombre = QtWidgets.QLineEdit(Principal)
        self.nombre.setObjectName("nombre")
        self.formLayout.setWidget(5, QtWidgets.QFormLayout.LabelRole, self.nombre)
        self.label_4 = QtWidgets.QLabel(Principal)
        self.label_4.setObjectName("label_4")
        self.formLayout.setWidget(6, QtWidgets.QFormLayout.LabelRole, self.label_4)
        self.documento = QtWidgets.QLineEdit(Principal)
        self.documento.setObjectName("documento")
        self.formLayout.setWidget(8, QtWidgets.QFormLayout.LabelRole, self.documento)
        self.label_5 = QtWidgets.QLabel(Principal)
        self.label_5.setObjectName("label_5")
        self.formLayout.setWidget(9, QtWidgets.QFormLayout.LabelRole, self.label_5)
        self.cargo = QtWidgets.QLineEdit(Principal)
        self.cargo.setObjectName("cargo")
        self.formLayout.setWidget(10, QtWidgets.QFormLayout.LabelRole, self.cargo)
        self.Ejecutar = QtWidgets.QPushButton(Principal)
        self.Ejecutar.setObjectName("Ejecutar")
        self.formLayout.setWidget(11, QtWidgets.QFormLayout.LabelRole, self.Ejecutar)
        self.clave = QtWidgets.QLineEdit(Principal)
        self.clave.setTabletTracking(False)
        self.clave.setAutoFillBackground(False)
        self.clave.setEchoMode(QtWidgets.QLineEdit.Password)
        self.clave.setDragEnabled(False)
        self.clave.setObjectName("clave")
        self.formLayout.setWidget(3, QtWidgets.QFormLayout.LabelRole, self.clave)
        self.Ejecutar.clicked.connect(self.pagina)

        self.retranslateUi(Principal)
        QtCore.QMetaObject.connectSlotsByName(Principal)

    def retranslateUi(self, Principal):
        _translate = QtCore.QCoreApplication.translate
        Principal.setWindowTitle(_translate("Principal", "Covid-19"))
        self.label.setText(_translate("Principal", "Correo"))
        self.label_2.setText(_translate("Principal", "Clave"))
        self.label_3.setText(_translate("Principal", "Nombre"))
        self.label_4.setText(_translate("Principal", "Documento"))
        self.label_5.setText(_translate("Principal", "Cargo"))
        self.Ejecutar.setText(_translate("Principal", "Ejecutar"))
    
    def pagina(self, Principal):
        opciones = webdriver.ChromeOptions()
        opciones.add_argument('--star-maximized')
        opciones.add_argument('--disable-extensions')

        driver_path = '/usr/bin/chromedriver'
        driver = webdriver.Chrome(driver_path, chrome_options=opciones)

        driver.set_window_position(2000, 0)
        driver.maximize_window()

        time.sleep(1)

        driver.get('https://docs.google.com/forms/d/e/1FAIpQLSdU3SvhuMTIx4rbSHoLLoZ8PmVcMMse2LdCbVgLsNB9Z8r4vQ/viewform')

        login_attempt = driver.find_element_by_xpath("//*[@id='SMMuxb']/a[1]")
        login_attempt.click()
        driver.switch_to.window(driver.window_handles[1])
        campo_login = driver.find_element_by_xpath("//*[@id='identifierId']")
        var = self.correo.text()
        campo_login.send_keys(f"csi1@grupogema.com.co")
        campo_login.send_keys(Keys.RETURN)
        time.sleep(3)
        campo_clave = driver.find_element_by_name("password")
        var = self.clave.text()
        campo_clave.send_keys(f"GG%2021abc")
        campo_clave.send_keys(Keys.RETURN) 
        time.sleep(2)
        nombre = driver.find_element_by_xpath("//*[@id='mG61Hd']/div[2]/div/div[2]/div[1]/div/div/div[2]/div/div[1]/div/div[1]/input")
        var = self.nombre.text()
        nombre.send_keys(f"William Acosta Mosquera")
        nombre.send_keys(Keys.RETURN) 
        documento = driver.find_element_by_xpath("//*[@id='mG61Hd']/div[2]/div/div[2]/div[2]/div/div/div[2]/div/div[1]/div/div[1]/input")
        var = self.documento.text()
        documento.send_keys(f"1014302619")
        documento.send_keys(Keys.RETURN)
        cargo = driver.find_element_by_xpath("//*[@id='mG61Hd']/div[2]/div/div[2]/div[3]/div/div/div[2]/div/div[1]/div/div[1]/input")
        var = self.cargo.text()
        cargo.send_keys(f"webmaster")
        documento.send_keys(Keys.RETURN)
        ciudad = driver.find_element_by_xpath("//*[@id='mG61Hd']/div[2]/div/div[2]/div[4]/div/div/div[2]/div/div[1]/div/div[1]/input")
        ciudad.send_keys(f"Bogota")
        documento.send_keys(Keys.RETURN)
        fecha = driver.find_element_by_xpath('//*[@id="mG61Hd"]/div[2]/div/div[2]/div[5]/div/div/div[2]/div/div/div[2]/div[1]/div/div[1]/input')
        fecha1 = datetime.datetime.now()
        fecha.send_keys(f"{fecha1.day}-{fecha1.month}-{fecha1.year}")
        documento.send_keys(Keys.RETURN)
        eps = driver.find_element_by_xpath('//*[@id="mG61Hd"]/div[2]/div/div[2]/div[6]/div/div/div[2]/div/div[1]/div/div[1]/input')
        eps.send_keys(f"Compensar")
        eps.send_keys(Keys.RETURN)
        p1 = driver.find_element_by_xpath('//*[@id="i33"]/div[3]/div')
        p1.click()
        p2 = driver.find_element_by_xpath('//*[@id="i43"]/div[3]/div')
        p2.click()
        p3 = driver.find_element_by_xpath('//*[@id="i53"]/div[3]/div')
        p3.click()
        p4 = driver.find_element_by_xpath('//*[@id="i63"]/div[3]/div')
        p4.click()
        p5 = driver.find_element_by_xpath('//*[@id="i73"]/div[3]/div')
        p5.click()
        p6 = driver.find_element_by_xpath('//*[@id="i83"]/div[3]/div')
        p6.click()
        p7 = driver.find_element_by_xpath('//*[@id="i93"]/div[3]/div')
        p7.click()
        p8 = driver.find_element_by_xpath('//*[@id="i103"]/div[3]/div')
        p8.click()
        p9 = driver.find_element_by_xpath('//*[@id="i113"]/div[3]/div')
        p9.click()
        p10 = driver.find_element_by_xpath('//*[@id="i123"]/div[3]/div')
        p10.click()
        p10_1 = driver.find_element_by_xpath('//*[@id="mG61Hd"]/div[2]/div/div[2]/div[17]/div/div/div[2]/div/div[1]/div/div[1]/input')
        p10_1.send_keys(f"N/A")
        p10_1.send_keys(Keys.RETURN)
        p11 = driver.find_element_by_xpath('//*[@id="i137"]/div[3]/div')
        p11.click()
        p12 = driver.find_element_by_xpath('//*[@id="i147"]/div[3]/div')
        p12.click()
        p12_1 = driver.find_element_by_xpath('//*[@id="mG61Hd"]/div[2]/div/div[2]/div[20]/div/div/div[2]/div/div[1]/div/div[1]/input')
        p12_1.send_keys(f"N/A")
        p12_1.send_keys(Keys.RETURN)
        p13 = driver.find_element_by_xpath('//*[@id="i161"]/div[3]/div')
        p13.click()
        p13_1 = driver.find_element_by_xpath('//*[@id="mG61Hd"]/div[2]/div/div[2]/div[22]/div/div/div[2]/div/div[1]/div/div[1]/input')
        p13_1.send_keys(f"N/A")
        p13_1.send_keys(Keys.RETURN)
        p14 = driver.find_element_by_xpath('//*[@id="i175"]/div[3]/div')
        p14.click()
        p14_1 = driver.find_element_by_xpath('//*[@id="mG61Hd"]/div[2]/div/div[2]/div[24]/div/div/div[2]/div/div[1]/div/div[1]/input')
        p14_1.send_keys(f"N/A")
        p14_1.send_keys(Keys.RETURN)
        p15 = driver.find_element_by_xpath('//*[@id="i189"]/div[3]/div')
        p15.click()
        p15_1 = driver.find_element_by_xpath('//*[@id="mG61Hd"]/div[2]/div/div[2]/div[26]/div/div/div[2]/div/div[1]/div[2]/textarea')
        p15_1.send_keys(f"N/A")
        p15_1.send_keys(Keys.RETURN)
        p15 = driver.find_element_by_xpath('//*[@id="mG61Hd"]/div[2]/div/div[3]/div[1]/div[1]/div/span/span')
        p15.click()
        
        

if __name__ == "__main__":
    import sys
    app = QtWidgets.QApplication(sys.argv)
    Principal = QtWidgets.QDialog()
    ui = Ui_Principal()
    ui.setupUi(Principal)
    Principal.show()
    sys.exit(app.exec_())
